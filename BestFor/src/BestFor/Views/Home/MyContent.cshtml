@model BestFor.Dto.AnswerDetailsDto
@using BestFor.Services
@* Inject the service that generates anti forgery keys *@
@inject Microsoft.AspNet.Antiforgery.IAntiforgery Xsrf
@* Inject the service that allows searching for localized strings *@
@inject BestFor.Services.Services.IResourcesService resourcesService
@functions
{
    // Generate the token that we will use in requests sending data to server in headers.
    public string GetAntiXsrfToken()
    {
        var tokens = Xsrf.GetTokens(Context);
        return tokens.CookieToken + ":" + tokens.FormToken;
    }
}
@{
    // Read localized strings
    string addDescription = resourcesService.GetString(this.ViewBag.BestForCulture, "add_description");
    string answerDetails = resourcesService.GetString(this.ViewBag.BestForCulture, "answer_details");
    string flagString = resourcesService.GetCommonStrings(this.ViewBag.BestForCulture).FlagLower;
}
@LinkingHelper.ConvertAnswerToText(Model.CommonStrings, Model.Answer)
<br /><br />
@foreach (var item in Model.Descriptions)
{
    @Html.DisplayFor(x => item.Description)<br /><br />
}
<yakor y-culture="@this.ViewBag.BestForCulture" y-controller="AnswerAction" y-action="AddDescription"
       y-querystring="@new { answerId = Model.Answer.Id }">@addDescription</yakor>
<br /><br />
<yakor y-culture="@this.ViewBag.BestForCulture" y-controller="AnswerAction" y-action="ShowAnswer"
       y-querystring="@new { answerId = Model.Answer.Id }">@answerDetails</yakor>
<br />
<yakor y-culture="@this.ViewBag.BestForCulture" y-controller="Flag" y-action="FlagAnswer"
       y-querystring="@new { answerId = Model.Answer.Id }">@flagString</yakor>
<br />
<br />
@Html.React("AffiliateProductDetails",
        new
        {
            productsUrl = "/api/product",
            productKeyword = Model.Answer.LeftWord + " " + Model.Answer.RightWord + " " + Model.Answer.Phrase,
            antiForgeryHeaderName = BestFor.Controllers.BaseApiController.ANTI_FORGERY_HEADER_NAME,
            antiForgeryToken = GetAntiXsrfToken(),
            resourceStrings = resourcesService.GetStringsAsJson(this.ViewBag.BestForCulture,
                new string[]
                {
                    "title_upper",
                    "link_upper",
                    "price_upper",
                    "not_able_to_find_product"
                })
        })
@* Load react client scripts *@
@section TopScripts {
    @{ await Html.RenderPartialAsync("_ReactJsScriptsPartial"); }
}
@* Load this page specific react sripts *@
<script src="@Url.Content("~/Scripts/AffiliateProductDetails.jsx")"></script>
@Html.ReactInitJavaScript()




